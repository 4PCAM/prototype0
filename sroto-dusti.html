<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sroto Dusti Assessment - 4-PCAM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .assessment-header {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 25px;
        }

        .assessment-header h3 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .instructions {
            background: #e8f4fd;
            color: #2d3436;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid #74b9ff;
            font-weight: 500;
        }

        .patient-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .srotas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .srotas-card {
            background: #fff;
            border: 1px solid #dee2e6;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .srotas-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
        }

        .srotas-header {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            padding: 15px;
            text-align: center;
            font-weight: 600;
            color: #2d3436;
        }

        .srotas-content {
            padding: 20px;
        }

        .symptom-checklist {
            list-style: none;
            padding: 0;
        }

        .symptom-item {
            background: #f8f9fa;
            margin: 8px 0;
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .symptom-item:hover {
            background: #e3f2fd;
            border-color: #667eea;
        }

        .symptom-item.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .severity-controls {
            display: none;
            gap: 5px;
        }

        .symptom-item.selected .severity-controls {
            display: flex;
        }

        .severity-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
            min-width: 30px;
        }

        .severity-btn:hover, .severity-btn.active {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        .srotas-score {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            margin-top: 15px;
        }

        .score-value {
            font-size: 24px;
            font-weight: bold;
            display: block;
        }

        .selected-srotas-symptoms {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
        }

        .selected-srotas-symptoms h5 {
            color: #856404;
            margin-bottom: 10px;
        }

        .srotas-symptom-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .srotas-summary-card {
            background: #fff;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #ffeaa7;
        }

        .srotas-summary-card h6 {
            color: #856404;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .summary-symptom {
            background: #f8f9fa;
            padding: 6px 8px;
            margin: 4px 0;
            border-radius: 4px;
            font-size: 12px;
            border-left: 3px solid #667eea;
        }

        .results-section {
            background: #f1f2f6;
            padding: 25px;
            border-radius: 12px;
            margin-top: 25px;
        }

        .results-section h4 {
            color: #2d3436;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .severity-indicator {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            margin: 5px;
            font-size: 13px;
        }

        .normal { background: #00b894; color: white; }
        .mild { background: #fdcb6e; color: #2d3436; }
        .moderate { background: #e17055; color: white; }
        .severe { background: #d63031; color: white; }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #636e72, #2d3436);
            color: white;
        }

        .btn:disabled {
            background: #ddd;
            color: #999;
            cursor: not-allowed;
            transform: none;
        }

        @media (max-width: 768px) {
            .srotas-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .patient-info {
                grid-template-columns: 1fr;
            }
            
            .srotas-symptom-summary {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåä COMPLETE SROTO DUSTI ASSESSMENT</h1>
            <p><strong>PILLAR 4 of 4-PCAM</strong></p>
            <p>All 15 Classical Srotas - Complete Channel System Evaluation</p>
        </div>

        <div class="content">
            <div class="patient-info" id="patient-info">
                <!-- Patient info will be loaded here -->
            </div>

            <div class="assessment-header">
                <h3>üåä COMPLETE 15-SROTAS ASSESSMENT</h3>
                <p>Comprehensive evaluation of all classical body channels based on traditional lakshanas</p>
            </div>

            <div class="instructions">
                <strong>üìã INSTRUCTIONS:</strong> This is the complete 15-srotas assessment as per classical Ayurvedic texts. Score 0-2 per symptom (0=Absent, 1=Mild, 2=Severe). Click symptoms present, then select severity. Each srotas represents a specific physiological channel system.<br>
                <small><em>Note: Most srotas have 5 symptoms each, except Rasavaha which has 6 symptoms, for a total of 76 symptoms across all 15 srotas.</em></small>
            </div>

            <div class="srotas-grid">
                <!-- 1. PRANAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>ü´Å 1. PRANAVAHA SROTAS</h4>
                        <small>(Vital Air/Respiratory Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="pranavaha" data-symptom="Breathlessness">
                                <span>Breathlessness</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="pranavaha" data-symptom="Cough">
                                <span>Cough</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="pranavaha" data-symptom="Chest pain">
                                <span>Chest pain</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="pranavaha" data-symptom="Respiratory infections">
                                <span>Respiratory infections</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="pranavaha" data-symptom="Asthma symptoms">
                                <span>Asthma symptoms</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="pranavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 2. UDAKAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üíß 2. UDAKAVAHA SROTAS</h4>
                        <small>(Water Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="udakavaha" data-symptom="Excessive thirst">
                                <span>Excessive thirst</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="udakavaha" data-symptom="Dry mouth">
                                <span>Dry mouth</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="udakavaha" data-symptom="Dehydration symptoms">
                                <span>Dehydration symptoms</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="udakavaha" data-symptom="Water retention">
                                <span>Water retention</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="udakavaha" data-symptom="Edema">
                                <span>Edema</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="udakavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 3. ANNAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üçΩÔ∏è 3. ANNAVAHA SROTAS</h4>
                        <small>(Food Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="annavaha" data-symptom="Loss of appetite">
                                <span>Loss of appetite</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="annavaha" data-symptom="Indigestion">
                                <span>Indigestion</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="annavaha" data-symptom="Vomiting">
                                <span>Vomiting</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="annavaha" data-symptom="Abdominal pain">
                                <span>Abdominal pain</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="annavaha" data-symptom="Distention after food">
                                <span>Distention after food</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="annavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 4. RASAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üíß 4. RASAVAHA SROTAS</h4>
                        <small>(Plasma Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="rasavaha" data-symptom="Loss of appetite">
                                <span>Loss of appetite</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="rasavaha" data-symptom="Nausea">
                                <span>Nausea</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="rasavaha" data-symptom="Excessive salivation">
                                <span>Excessive salivation</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="rasavaha" data-symptom="Heaviness in body">
                                <span>Heaviness in body</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="rasavaha" data-symptom="Fever">
                                <span>Fever</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="rasavaha" data-symptom="Anemia">
                                <span>Anemia</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="rasavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 5. RAKTAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>ü©∏ 5. RAKTAVAHA SROTAS</h4>
                        <small>(Blood Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="raktavaha" data-symptom="Skin diseases">
                                <span>Skin diseases</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="raktavaha" data-symptom="Bleeding disorders">
                                <span>Bleeding disorders</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="raktavaha" data-symptom="Inflammation">
                                <span>Inflammation</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="raktavaha" data-symptom="Abscess formation">
                                <span>Abscess formation</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="raktavaha" data-symptom="Spleen enlargement">
                                <span>Spleen enlargement</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="raktavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 6. MAMSAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üí™ 6. MAMSAVAHA SROTAS</h4>
                        <small>(Muscle Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="mamsavaha" data-symptom="Muscle tumors">
                                <span>Muscle tumors</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="mamsavaha" data-symptom="Abnormal growths">
                                <span>Abnormal growths</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="mamsavaha" data-symptom="Throat diseases">
                                <span>Throat diseases</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="mamsavaha" data-symptom="Goiter">
                                <span>Goiter</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="mamsavaha" data-symptom="Granuloma formation">
                                <span>Granuloma formation</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="mamsavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 7. MEDAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>ü´Ö 7. MEDAVAHA SROTAS</h4>
                        <small>(Adipose Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="medavaha" data-symptom="Excessive urination">
                                <span>Excessive urination</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="medavaha" data-symptom="Excessive thirst">
                                <span>Excessive thirst</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="medavaha" data-symptom="Fatty tumors">
                                <span>Fatty tumors</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="medavaha" data-symptom="Diabetes symptoms">
                                <span>Diabetes symptoms</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="medavaha" data-symptom="Obesity">
                                <span>Obesity</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="medavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 8. ASTHIVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>ü¶¥ 8. ASTHIVAHA SROTAS</h4>
                        <small>(Bone Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="asthivaha" data-symptom="Hair and nail disorders">
                                <span>Hair and nail disorders</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="asthivaha" data-symptom="Teeth problems">
                                <span>Teeth problems</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="asthivaha" data-symptom="Bone pain">
                                <span>Bone pain</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="asthivaha" data-symptom="Joint disorders">
                                <span>Joint disorders</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="asthivaha" data-symptom="Bone deformities">
                                <span>Bone deformities</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="asthivaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 9. MAJJAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üß† 9. MAJJAVAHA SROTAS</h4>
                        <small>(Nerve/Marrow Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="majjavaha" data-symptom="Dizziness">
                                <span>Dizziness</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="majjavaha" data-symptom="Unconsciousness">
                                <span>Unconsciousness</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="majjavaha" data-symptom="Neurological disorders">
                                <span>Neurological disorders</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="majjavaha" data-symptom="Memory problems">
                                <span>Memory problems</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="majjavaha" data-symptom="Bone marrow disorders">
                                <span>Bone marrow disorders</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="majjavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 10. SHUKRAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üå± 10. SHUKRAVAHA SROTAS</h4>
                        <small>(Reproductive Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="shukravaha" data-symptom="Impotence">
                                <span>Impotence</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="shukravaha" data-symptom="Infertility">
                                <span>Infertility</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="shukravaha" data-symptom="Urinary disorders">
                                <span>Urinary disorders</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="shukravaha" data-symptom="Genital diseases">
                                <span>Genital diseases</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="shukravaha" data-symptom="Prostate problems">
                                <span>Prostate problems</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="shukravaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 11. MUTRAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üíß 11. MUTRAVAHA SROTAS</h4>
                        <small>(Urine Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="mutravaha" data-symptom="Retention of urine">
                                <span>Retention of urine</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="mutravaha" data-symptom="Excessive urination">
                                <span>Excessive urination</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="mutravaha" data-symptom="Painful urination">
                                <span>Painful urination</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="mutravaha" data-symptom="Urinary stones">
                                <span>Urinary stones</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="mutravaha" data-symptom="Blood in urine">
                                <span>Blood in urine</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                
                <div class="srotas-score">
                            <span class="score-value" id="mutravaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 12. PURISHAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üöΩ 12. PURISHAVAHA SROTAS</h4>
                        <small>(Waste/Feces Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="purishavaha" data-symptom="Constipation">
                                <span>Constipation</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="purishavaha" data-symptom="Diarrhea">
                                <span>Diarrhea</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="purishavaha" data-symptom="Abdominal distention">
                                <span>Abdominal distention</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="purishavaha" data-symptom="Flatulence">
                                <span>Flatulence</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>        
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            <li class="symptom-item" data-srotas="purishavaha" data-symptom="Anal disorders">
                                <span>Anal disorders</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="purishavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>  

                <!-- 13. SWEDAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üí¶ 13. SWEDAVAHA SROTAS</h4>
                        <small>(Sweat Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="swedavaha" data-symptom="Excessive sweating">
                                <span>Excessive sweating</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="swedavaha" data-symptom="Absent sweating">
                                <span>Absent sweating</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="swedavaha" data-symptom="Foul smelling sweat">
                                <span>Foul smelling sweat</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="swedavaha" data-symptom="Skin infections from sweat">
                                <span>Skin infections from sweat</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="swedavaha" data-symptom="Temperature regulation issues">
                                <span>Temperature regulation issues</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="swedavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 14. ARTAVAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>üå∏ 14. ARTAVAVAHA SROTAS</h4>
                        <small>(Menstrual/Female Reproductive Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="artavavaha" data-symptom="Irregular menstruation">
                                <span>Irregular menstruation</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="artavavaha" data-symptom="Painful menstruation">
                                <span>Painful menstruation</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="artavavaha" data-symptom="Excessive bleeding">
                                <span>Excessive bleeding</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="artavavaha" data-symptom="Amenorrhea">
                                <span>Amenorrhea</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="artavavaha" data-symptom="Uterine disorders">
                                <span>Uterine disorders</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="artavavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>

                <!-- 15. STANYAVAHA SROTAS -->
                <div class="srotas-card">
                    <div class="srotas-header">
                        <h4>ü§± 15. STANYAVAHA SROTAS</h4>
                        <small>(Breast Milk Carrying Channels)</small>
                    </div>
                    <div class="srotas-content">
                        <ul class="symptom-checklist">
                            <li class="symptom-item" data-srotas="stanyavaha" data-symptom="Insufficient milk production">
                                <span>Insufficient milk production</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="stanyavaha" data-symptom="Excessive milk production">
                                <span>Excessive milk production</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="stanyavaha" data-symptom="Breast infections">
                                <span>Breast infections</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="stanyavaha" data-symptom="Breast lumps">
                                <span>Breast lumps</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                            <li class="symptom-item" data-srotas="stanyavaha" data-symptom="Nipple disorders">
                                <span>Nipple disorders</span>
                                <div class="severity-controls">
                                    <button class="severity-btn" data-score="1">1</button>
                                    <button class="severity-btn" data-score="2">2</button>
                                </div>
                            </li>
                        </ul>
                        <div class="srotas-score">
                            <span class="score-value" id="stanyavaha-score">0</span>
                            Total Score
                        </div>
                    </div>
                </div>
            </div>

            <div class="results-section">
                <h4>üìä Complete Srotas Assessment Results</h4>
                <div id="srotas-results">Please select symptoms to view assessment results...</div>
            </div>

            <div class="nav-buttons">
                <a href="dhatu-dusti.html" class="btn btn-secondary">‚Üê Back to Dhatu Assessment</a>
                <button class="btn btn-primary" id="srotas-complete-btn" onclick="completeSrotasAssessment()">Complete Assessment</button>
            </div>
        </div>
    </div>

    <script>
        // Complete Srotas assessment data for all 15 srotas
        let srotasData = {
            scores: {
                pranavaha: 0,
                udakavaha: 0,
                annavaha: 0,
                rasavaha: 0,
                raktavaha: 0,
                mamsavaha: 0,
                medavaha: 0,
                asthivaha: 0,
                majjavaha: 0,
                shukravaha: 0,
                mutravaha: 0,
                purishavaha: 0,
                swedavaha: 0,
                artavavaha: 0,
                stanyavaha: 0
            },
            selectedSymptoms: {
                pranavaha: [],
                udakavaha: [],
                annavaha: [],
                rasavaha: [],
                raktavaha: [],
                mamsavaha: [],
                medavaha: [],
                asthivaha: [],
                majjavaha: [],
                shukravaha: [],
                mutravaha: [],
                purishavaha: [],
                swedavaha: [],
                artavavaha: [],
                stanyavaha: []
            },
            completed: false
        };

        // Initialize all srotas data to ensure consistency
        function initializeSrotasData() {
            const allSrotas = [
                'pranavaha', 'udakavaha', 'annavaha', 'rasavaha', 'raktavaha',
                'mamsavaha', 'medavaha', 'asthivaha', 'majjavaha', 'shukravaha',
                'mutravaha', 'purishavaha', 'swedavaha', 'artavavaha', 'stanyavaha'
            ];

            // Ensure all srotas exist in scores object
            allSrotas.forEach(srotas => {
                if (!srotasData.scores.hasOwnProperty(srotas)) {
                    srotasData.scores[srotas] = 0;
                }
                if (!srotasData.selectedSymptoms.hasOwnProperty(srotas)) {
                    srotasData.selectedSymptoms[srotas] = [];
                }
            });

            console.log('‚úÖ All srotas data initialized:', Object.keys(srotasData.scores));
        }

        let patientData = {};
        let agniData = {};
        let doshaData = {};
        let dhatuData = {};

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeSrotasData();
            loadPreviousData();
            loadPreviousSrotasData();
            addEventListeners();
            updateDisplay();
            console.log('üåä Complete Srotas Assessment System initialized with all 15 srotas');
        });

        function loadPreviousData() {
            // Load combined data
            const combined = localStorage.getItem('4pcam_combined_data');
            if (combined) {
                try {
                    const data = JSON.parse(combined);
                    patientData = data.patient || {};
                    agniData = data.agni || {};
                    doshaData = data.dosha || {};
                    dhatuData = data.dhatu || {};
                    displayPatientInfo();
                } catch (e) {
                    console.log('Could not load combined data');
                }
            }

            // If prerequisites not completed, redirect
            if (!patientData.name || !agniData.completed || !doshaData.completed || !dhatuData.completed) {
                alert('Please complete all previous assessments (Patient Info, Agni, Dosha, Dhatu) first.');
                window.location.href = 'patient-info.html';
            }
        }

        function displayPatientInfo() {
            const infoEl = document.getElementById('patient-info');
            if (patientData.name) {
                const agniStatus = getAgniStatus();
                const doshaStatus = getDoshaStatus();
                const dhatuStatus = getDhatuStatus();
                
                infoEl.innerHTML = `
                    <div><strong>Patient:</strong> ${patientData.name}</div>
                    <div><strong>Age/Sex:</strong> ${patientData.ageSex}</div>
                    <div><strong>Date:</strong> ${patientData.assessmentDate}</div>
                    <div><strong>Agni:</strong> ${agniStatus}</div>
                    <div><strong>Dosha:</strong> ${doshaStatus}</div>
                    <div><strong>Dhatu:</strong> ${dhatuStatus}</div>
                `;
            }
        }

        function getAgniStatus() {
            if (!agniData.completed) return 'Not completed';
            const totalDusti = (agniData.vishama || 0) + (agniData.tikshna || 0) + (agniData.manda || 0);
            if (totalDusti === 0) return 'Sama Agni';
            if (totalDusti <= 4) return 'Mild Dusti';
            return 'Moderate-Severe Dusti';
        }

        function getDoshaStatus() {
            if (!doshaData.completed) return 'Not completed';
            const vata = doshaData.vata || 0;
            const pitta = doshaData.pitta || 0;
            const kapha = doshaData.kapha || 0;
            const max = Math.max(vata, pitta, kapha);
            
            if (max === vata && vata > 0) return `Vata Dominant`;
            if (max === pitta && pitta > 0) return `Pitta Dominant`;
            if (max === kapha && kapha > 0) return `Kapha Dominant`;
            return 'Balanced';
        }

        function getDhatuStatus() {
            if (!dhatuData.completed) return 'Not completed';
            const totalSymptoms = Object.values(dhatuData.selectedSymptoms || {}).reduce((total, dhatu) => {
                return total + (dhatu.kshaya ? dhatu.kshaya.length : 0) + (dhatu.vriddhi ? dhatu.vriddhi.length : 0);
            }, 0);
            return `${totalSymptoms} symptoms identified`;
        }

        function addEventListeners() {
            // Add click listeners to all symptom items
            document.querySelectorAll('.symptom-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    // Don't trigger if clicking on severity buttons
                    if (e.target.classList.contains('severity-btn')) {
                        return;
                    }
                    handleSymptomClick(this);
                });
            });

            // Add click listeners to severity buttons
            document.querySelectorAll('.severity-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    e.preventDefault();
                    handleSeverityClick(this);
                });
            });
        }

        function handleSymptomClick(item) {
            const srotas = item.dataset.srotas;
            const symptom = item.dataset.symptom;

            // Toggle selection
            if (item.classList.contains('selected')) {
                // Deselect
                item.classList.remove('selected');
                removeSymptom(srotas, symptom);
            } else {
                // Select with default severity 1
                item.classList.add('selected');
                addSymptom(srotas, symptom, 1);
                // Set default severity button
                const severityBtn1 = item.querySelector('.severity-btn[data-score="1"]');
                if (severityBtn1) {
                    item.querySelectorAll('.severity-btn').forEach(b => b.classList.remove('active'));
                    severityBtn1.classList.add('active');
                }
            }

            updateDisplay();
            saveSrotasData();
        }

        function handleSeverityClick(btn) {
            const item = btn.closest('.symptom-item');
            const srotas = item.dataset.srotas;
            const symptom = item.dataset.symptom;
            const severity = parseInt(btn.dataset.score);

            // Update severity button visual state
            item.querySelectorAll('.severity-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // Update symptom with new severity
            updateSymptomSeverity(srotas, symptom, severity);

            updateDisplay();
            saveSrotasData();
        }

        function addSymptom(srotas, symptom, severity = 1) {
            if (!srotasData.selectedSymptoms[srotas]) {
                console.error(`Invalid srotas: ${srotas}`);
                return;
            }

            // Remove if already exists
            removeSymptom(srotas, symptom);
            
            // Add new symptom
            srotasData.selectedSymptoms[srotas].push({
                symptom: symptom,
                severity: severity
            });

            // Update scores
            if (!srotasData.scores[srotas]) {
                srotasData.scores[srotas] = 0;
            }
            srotasData.scores[srotas] += severity;
            
            console.log(`Added ${symptom} to ${srotas} with severity ${severity}. New score: ${srotasData.scores[srotas]}`);
        }

        function removeSymptom(srotas, symptom) {
            if (!srotasData.selectedSymptoms[srotas]) {
                console.error(`Invalid srotas: ${srotas}`);
                return;
            }

            const symptoms = srotasData.selectedSymptoms[srotas];
            const index = symptoms.findIndex(s => s.symptom === symptom);
            
            if (index !== -1) {
                // Remove from score
                if (!srotasData.scores[srotas]) {
                    srotasData.scores[srotas] = 0;
                }
                srotasData.scores[srotas] -= symptoms[index].severity;
                
                // Ensure score doesn't go negative
                if (srotasData.scores[srotas] < 0) {
                    srotasData.scores[srotas] = 0;
                }
                
                // Remove from array
                symptoms.splice(index, 1);
                
                console.log(`Removed ${symptom} from ${srotas}. New score: ${srotasData.scores[srotas]}`);
            }
        }

        function updateSymptomSeverity(srotas, symptom, newSeverity) {
            const symptoms = srotasData.selectedSymptoms[srotas];
            const symptomObj = symptoms.find(s => s.symptom === symptom);
            
            if (symptomObj) {
                // Update score (subtract old, add new)
                srotasData.scores[srotas] -= symptomObj.severity;
                srotasData.scores[srotas] += newSeverity;
                
                // Update severity
                symptomObj.severity = newSeverity;
            }
        }

        function loadPreviousSrotasData() {
            const saved = localStorage.getItem('4pcam_srotas_data');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    
                    // Merge saved data with initialized structure
                    if (data.scores) {
                        Object.keys(data.scores).forEach(srotas => {
                            if (srotasData.scores.hasOwnProperty(srotas)) {
                                srotasData.scores[srotas] = data.scores[srotas];
                            }
                        });
                    }
                    
                    if (data.selectedSymptoms) {
                        Object.keys(data.selectedSymptoms).forEach(srotas => {
                            if (srotasData.selectedSymptoms.hasOwnProperty(srotas)) {
                                srotasData.selectedSymptoms[srotas] = data.selectedSymptoms[srotas] || [];
                            }
                        });
                    }
                    
                    srotasData.completed = data.completed || false;
                    srotasData.timestamp = data.timestamp;
                    
                    restoreSelections();
                    console.log('‚úÖ Previous srotas data loaded and merged');
                } catch (e) {
                    console.log('Could not load previous srotas data:', e);
                }
            } else {
                console.log('No previous srotas data found - starting fresh');
            }
        }

        function restoreSelections() {
            // Restore selected symptoms and their severities
            Object.keys(srotasData.selectedSymptoms).forEach(srotas => {
                srotasData.selectedSymptoms[srotas].forEach(symptomObj => {
                    const item = document.querySelector(`[data-srotas="${srotas}"][data-symptom="${symptomObj.symptom}"]`);
                    if (item) {
                        item.classList.add('selected');
                        const severityBtn = item.querySelector(`[data-score="${symptomObj.severity}"]`);
                        if (severityBtn) {
                            item.querySelectorAll('.severity-btn').forEach(b => b.classList.remove('active'));
                            severityBtn.classList.add('active');
                        }
                    }
                });
            });
        }

        function updateDisplay() {
            // Update score displays for all srotas
            const allSrotas = [
                'pranavaha', 'udakavaha', 'annavaha', 'rasavaha', 'raktavaha',
                'mamsavaha', 'medavaha', 'asthivaha', 'majjavaha', 'shukravaha',
                'mutravaha', 'purishavaha', 'swedavaha', 'artavavaha', 'stanyavaha'
            ];

            allSrotas.forEach(srotas => {
                const scoreEl = document.getElementById(`${srotas}-score`);
                if (scoreEl) {
                    const currentScore = srotasData.scores[srotas] || 0;
                    scoreEl.textContent = currentScore;
                } else {
                    console.error(`Score element NOT FOUND for: ${srotas}-score`);
                }
            });

            // Update selected symptoms summary
            updateSelectedSymptoms();

            // Update results
            updateResults();

            // Update completion button
            updateCompletionButton();
        }

        function updateSelectedSymptoms() {
            const symptomsEl = document.getElementById('selected-symptoms');
            const summaryEl = document.getElementById('symptom-summary');
            
            let hasSymptoms = false;
            let summaryHTML = '';

            Object.keys(srotasData.selectedSymptoms).forEach(srotas => {
                const symptoms = srotasData.selectedSymptoms[srotas];
                
                if (symptoms.length > 0) {
                    hasSymptoms = true;
                    summaryHTML += `
                        <div class="srotas-summary-card">
                            <h6>${srotas.charAt(0).toUpperCase() + srotas.slice(1)} Srotas</h6>
                            ${symptoms.map(s => `<div class="summary-symptom">${s.symptom} (Severity: ${s.severity})</div>`).join('')}
                        </div>
                    `;
                }
            });

            if (hasSymptoms) {
                symptomsEl.style.display = 'block';
                summaryEl.innerHTML = summaryHTML;
            } else {
                symptomsEl.style.display = 'none';
            }
        }

        function updateResults() {
            let resultsHTML = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">';
            
            const srotasNames = {
                pranavaha: 'Pranavaha',
                udakavaha: 'Udakavaha',
                annavaha: 'Annavaha',
                rasavaha: 'Rasavaha',
                raktavaha: 'Raktavaha',
                mamsavaha: 'Mamsavaha',
                medavaha: 'Medavaha',
                asthivaha: 'Asthivaha',
                majjavaha: 'Majjavaha',
                shukravaha: 'Shukravaha',
                mutravaha: 'Mutravaha',
                purishavaha: 'Purishavaha',
                swedavaha: 'Swedavaha',
                artavavaha: 'Artavavaha',
                stanyavaha: 'Stanyavaha'
            };

            Object.keys(srotasData.scores).forEach(srotas => {
                const score = srotasData.scores[srotas];
                
                let severity = 'normal';
                let severityText = 'No significant dushti';
                
                if (score >= 1 && score <= 3) {
                    severity = 'mild';
                    severityText = 'Mild dushti';
                } else if (score >= 4 && score <= 6) {
                    severity = 'moderate';
                    severityText = 'Moderate dushti';
                } else if (score >= 7) {
                    severity = 'severe';
                    severityText = 'Severe dushti';
                }

                resultsHTML += `
                    <div>
                        <strong>${srotasNames[srotas]}:</strong> ${score}<br>
                        <span class="severity-indicator ${severity}">${severityText}</span>
                    </div>
                `;
            });
            
            resultsHTML += '</div>';
            
            const totalSymptoms = Object.values(srotasData.selectedSymptoms).reduce((total, symptoms) => {
                return total + symptoms.length;
            }, 0);
            
            const totalScore = Object.values(srotasData.scores).reduce((total, score) => total + score, 0);
            
            resultsHTML += `
                <div style="margin-top: 20px; padding: 15px; background: #e8f4fd; border-radius: 8px;">
                    <p><strong>Total Selected Symptoms:</strong> ${totalSymptoms} out of 76 possible</p>
                    <p><strong>Total Srotas Dushti Score:</strong> ${totalScore} out of 152 possible</p>
                    <p><strong>Overall Assessment:</strong> ${getOverallSrotasStatus(totalScore)}</p>
                    <p><strong>Systems Affected:</strong> ${getAffectedSystemsCount()} out of 15 srotas</p>
                </div>
            `;

            document.getElementById('srotas-results').innerHTML = resultsHTML;
        }

        function getAffectedSystemsCount() {
            return Object.values(srotasData.scores).filter(score => score > 0).length;
        }

        function getOverallSrotasStatus(totalScore) {
            if (totalScore === 0) return 'No significant srotas dushti identified';
            if (totalScore <= 15) return 'Mild overall srotas dysfunction';
            if (totalScore <= 30) return 'Moderate overall srotas dysfunction';
            if (totalScore <= 50) return 'Severe overall srotas dysfunction';
            if (totalScore <= 75) return 'Critical srotas dysfunction - requires immediate comprehensive treatment';
            return 'Extreme srotas pathology - emergency intervention required';
        }

        function updateCompletionButton() {
            const completeBtn = document.getElementById('srotas-complete-btn');
            const selectedCount = Object.values(srotasData.selectedSymptoms).reduce((total, symptoms) => {
                return total + symptoms.length;
            }, 0);

            // Enable button if at least some symptoms are selected or if no symptoms (indicating normal)
            if (selectedCount >= 0) {
                completeBtn.disabled = false;
                completeBtn.style.background = 'linear-gradient(135deg, #00b894, #00a085)';
            } else {
                completeBtn.disabled = true;
                completeBtn.style.background = '#ddd';
            }
        }

        function saveSrotasData() {
            srotasData.timestamp = new Date().toISOString();
            localStorage.setItem('4pcam_srotas_data', JSON.stringify(srotasData));
        }

        function completeSrotasAssessment() {
            // Mark as completed
            srotasData.completed = true;
            saveSrotasData();

            // Save combined data for final report
            saveCombinedData();

            const totalScore = Object.values(srotasData.scores).reduce((total, score) => total + score, 0);
            const affectedSystems = getAffectedSystemsCount();

            alert(`Complete Srotas Assessment Completed Successfully!\n\nTotal Score: ${totalScore}/152\nAffected Systems: ${affectedSystems}/15\n\nProceeding to Final Assessment Report...`);
            window.location.href = 'final-assessment.html';
        }

        function saveCombinedData() {
            let combinedData = {};
            
            // Load existing combined data
            const existing = localStorage.getItem('4pcam_combined_data');
            if (existing) {
                try {
                    combinedData = JSON.parse(existing);
                } catch (e) {
                    combinedData = {};
                }
            }

            // Update with current data
            combinedData.patient = patientData;
            combinedData.agni = agniData;
            combinedData.dosha = doshaData;
            combinedData.dhatu = dhatuData;
            combinedData.srotas = srotasData;
            combinedData.timestamp = new Date().toISOString();
            combinedData.completed = true;

            localStorage.setItem('4pcam_combined_data', JSON.stringify(combinedData));
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveSrotasData();
                alert('Srotas assessment data saved!');
            }
            if (e.key === 'Escape') {
                window.location.href = 'dhatu-dusti.html';
            }
        });

        console.log("‚úÖ Complete 15-Srotas Dusti Assessment System loaded successfully!");
    </script>
</body>
</html>

